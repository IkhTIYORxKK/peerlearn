<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PeerLearn - Online Education Platform</title>
    <style>
        /* Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background-color: #f5f7fa;
    color: #333;
    line-height: 1.6;
}

.page {
    display: none;
    min-height: 100vh;
    padding: 20px;
}

.page.active {
    display: block;
}

/* Common Components */
.btn {
    background-color: #4a6fa5;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
}

.btn:hover {
    background-color: #3a5a80;
}

.back-btn {
    background-color: #6c757d;
}

.back-btn:hover {
    background-color: #5a6268;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
}

.form-group input[type="text"],
.form-group input[type="password"],
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
}

.radio-group {
    display: flex;
    gap: 15px;
    margin-top: 10px;
}

.radio-group label {
    display: flex;
    align-items: center;
    gap: 5px;
    font-weight: normal;
}

/* Login Page */
.login-container {
    max-width: 500px;
    margin: 50px auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.login-container .logo {
    font-size: 28px;
    font-weight: bold;
    color: #4a6bff;
}

.login-form {
    text-align: left;
}

/* Assessment Page */
.assessment-container {
    max-width: 800px;
    margin: 30px auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
}

.subject-assessment {
    margin-bottom: 30px;
}

.subject-assessment h2 {
    margin-bottom: 15px;
    color: #4a6fa5;
}

.level-selector {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.level-selector.horizontal {
    grid-template-columns: repeat(3, 1fr);
}

.level-selector input[type="radio"] {
    display: none;
}

.level-card {
    background: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
}

.level-card h3 {
    color: #4a6fa5;
    margin-bottom: 5px;
}

.level-card p {
    color: #6c757d;
    font-size: 14px;
}

.level-selector input[type="radio"]:checked + .level-card {
    border-color: #4a6fa5;
    background-color: #e7f0ff;
}

/* Dashboard Styles */
.dashboard-container {
    max-width: 1200px;
    margin: 0 auto;
}

.dashboard-container header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.dashboard-container h1 {
    color: #4a6fa5;
}

.stats-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    text-align: center;
}

.stat-card h3 {
    color: #6c757d;
    font-size: 16px;
    margin-bottom: 10px;
}

.stat-card p {
    font-size: 24px;
    font-weight: bold;
    color: #4a6fa5;
}

.user-progress {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    margin-bottom: 30px;
    overflow-x: auto;
}

.user-progress table {
    width: 100%;
    border-collapse: collapse;
}

.user-progress th, .user-progress td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.user-progress th {
    background-color: #f8f9fa;
    color: #4a6fa5;
}

.courses-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.course-card {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s;
}

.course-card:hover {
    transform: translateY(-5px);
}

.course-card img {
    width: 100%;
    height: 160px;
    object-fit: cover;
}

.course-info {
    padding: 15px;
}

.course-info h3 {
    color: #4a6fa5;
    margin-bottom: 10px;
}

.course-info p {
    color: #6c757d;
    font-size: 14px;
    margin-bottom: 15px;
}

/* Lesson Page */
.lesson-container {
    max-width: 1000px;
    margin: 0 auto;
}

.video-container {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    height: 0;
    margin-bottom: 20px;
}

.video-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 8px;
}

.lesson-description {
    background: white;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 30px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
}

.quiz-prompt {
    background: white;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 30px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    text-align: center;
}

/* Comments Section */
.comments-section {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
}

.comment-form {
    margin-bottom: 20px;
}

.comment-form textarea {
    width: 100%;
    min-height: 100px;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    resize: vertical;
    margin-bottom: 10px;
}

.comment {
    border-bottom: 1px solid #eee;
    padding: 15px 0;
}

.comment:last-child {
    border-bottom: none;
}

.comment-header {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.comment-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #4a6fa5;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    font-weight: bold;
}

.comment-author {
    font-weight: bold;
    margin-right: 10px;
}

.comment-date {
    color: #6c757d;
    font-size: 14px;
}

.comment-body {
    padding-left: 50px;
}

.reply {
    margin-left: 50px;
    padding-left: 15px;
    border-left: 3px solid #eee;
}

/* Quiz Page */
.quiz-container {
    max-width: 800px;
    margin: 0 auto;
}

.quiz-question {
    background: white;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
}

.quiz-question h3 {
    margin-bottom: 15px;
    color: #4a6fa5;
}

.quiz-option {
    display: block;
    margin-bottom: 10px;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.quiz-option:hover {
    background-color: #f8f9fa;
}

.quiz-option input[type="radio"] {
    margin-right: 10px;
}

#submit-quiz {
    display: block;
    margin: 30px auto;
    padding: 15px 30px;
    font-size: 18px;
}

/* Responsive Design */
@media (max-width: 768px) {
    .stats-container {
        grid-template-columns: 1fr;
    }
    
    .level-selector {
        grid-template-columns: 1fr 1fr;
    }
    
    .level-selector.horizontal {
        grid-template-columns: 1fr;
    }
    
    .courses-grid {
        grid-template-columns: 1fr;
    }
}

    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="page active">
        <div class="login-container">
            <a href="index.html" style="text-decoration: none;"><div class="logo">PeerLearn</div></a>
            <div class="login-form">
                <h2>Login</h2>
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" required>
                    </div>
                    <div class="form-group">
                        <label>Login as:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="user-type" value="student" checked> Student</label>
                            <label><input type="radio" name="user-type" value="admin"> Admin</label>
                        </div>
                    </div>
                    <button type="submit" class="btn">Login</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Assessment Page (for students) -->
    <div id="assessment-page" class="page">
        <div class="assessment-container">
            <h1>Initial Assessment</h1>
            <p>Please evaluate your current knowledge level in each subject:</p>
            
            <form id="assessment-form">
                <div class="subject-assessment">
                    <h2>Mathematics</h2>
                    <div class="level-selector">
                        <label>
                            <input type="radio" name="math-level" value="1" required>
                            <div class="level-card">
                                <h3>Level 1</h3>
                                <p>Grades 3-4</p>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="math-level" value="2">
                            <div class="level-card">
                                <h3>Level 2</h3>
                                <p>Grades 5-6</p>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="math-level" value="3">
                            <div class="level-card">
                                <h3>Level 3</h3>
                                <p>Grades 7-8</p>
                            </div>
                        </label>
                        <label>
                            
                            <input type="radio" name="math-level" value="4">
                            <div class="level-card">
                                <h3>Level 4</h3>
                                <p>Grades 9-10</p>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="math-level" value="5">
                            <div class="level-card">
                                <h3>Level 5</h3>
                                <p>Grade 11</p>
                            </div>
                        </label>
                    </div>
                </div>
                
                <div class="subject-assessment">
                    <h2>Programming</h2>
                    <div class="level-selector horizontal">
                        <label>
                            <input type="radio" name="programming-level" value="junior" required>
                            <div class="level-card">
                                <h3>Junior</h3>
                                <p>HTML/CSS Basics</p>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="programming-level" value="middle">
                            <div class="level-card">
                                <h3>Middle</h3>
                                <p>JavaScript/TypeScript</p>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="programming-level" value="senior">
                            <div class="level-card">
                                <h3>Senior</h3>
                                <p>Django/React/PHP/Laravel</p>
                            </div>
                        </label>
                    </div>
                </div>
                
                <div class="subject-assessment">
                    <h2>English</h2>
                    <div class="level-selector">
                        <label>
                            <input type="radio" name="english-level" value="beginner" required>
                            <div class="level-card">
                                <h3>Beginner</h3>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="english-level" value="elementary">
                            <div class="level-card">
                                <h3>Elementary</h3>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="english-level" value="intermediate">
                            <div class="level-card">
                                <h3>Intermediate</h3>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="english-level" value="advanced">
                            <div class="level-card">
                                <h3>Advanced</h3>
                            </div>
                        </label>
                        <label>
                            <input type="radio" name="english-level" value="proficient">
                            <div class="level-card">
                                <h3>Proficient</h3>
                            </div>
                        </label>
                    </div>
                </div>
                
                <button type="submit" class="btn">Save and Continue</button>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="page">
        <div class="dashboard-container">
            <header>
                <h1>Admin Dashboard</h1>
                <button id="logout-btn" class="btn">Logout</button>
            </header>
            
            <div class="stats-container">
                <div class="stat-card">
                    <h3>Total Users</h3>
                    <p id="total-users">0</p>
                </div>
                <div class="stat-card">
                    <h3>Active Today</h3>
                    <p id="active-today">0</p>
                </div>
                <div class="stat-card">
                    <h3>Courses Available</h3>
                    <p id="total-courses">0</p>
                </div>
            </div>
            
            <div class="user-progress">
                <h2>User Progress</h2>
                <table>
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Math Level</th>
                            <th>Programming</th>
                            <th>English</th>
                            <th>Last Active</th>
                        </tr>
                    </thead>
                    <tbody id="user-progress-table">
                        <!-- Filled by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="courses-list">
                <h2>Available Courses</h2>
                <div id="courses-container" class="courses-grid">
                    <!-- Filled by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="student-dashboard" class="page">
        <div class="dashboard-container">
            <header>
                <h1>Welcome, <span id="student-name">Student</span></h1>
                <button id="student-logout-btn" class="btn">Logout</button>
            </header>
            
            <div class="recommended-courses">
                <h2>Recommended Courses</h2>
                
                <div class="subject-section">
                    <h3>Mathematics (Level <span id="math-level-display">1</span>)</h3>
                    <div id="math-courses" class="courses-grid">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>
                
                <div class="subject-section">
                    <h3>Programming (<span id="programming-level-display">Junior</span>)</h3>
                    <div id="programming-courses" class="courses-grid">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>
                
                <div class="subject-section">
                    <h3>English (<span id="english-level-display">Beginner</span>)</h3>
                    <div id="english-courses" class="courses-grid">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lesson Page -->
    <div id="lesson-page" class="page">
        <div class="lesson-container">
            <header>
                <button id="back-to-courses" class="btn back-btn">← Back to Courses</button>
                <h1 id="lesson-title">Lesson Title</h1>
            </header>
            
            <div class="video-container">
                <iframe width="1324" height="745" src="https://www.youtube.com/embed/NybHckSEQBI" title="Algebra Basics: What Is Algebra? - Math Antics" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            
            <div class="lesson-description">
                <h3>About This Lesson</h3>
                <p id="lesson-description-text">Loading description...</p>
            </div>
            
            <div class="quiz-prompt">
                <h3>Test Your Knowledge</h3>
                <p>Complete the quiz to advance to the next level.</p>
                <button id="start-quiz-btn" class="btn">Take Quiz</button>
            </div>
            
            <div class="comments-section">
                <h3>Discussion</h3>
                
                <form id="comment-form" class="comment-form">
                    <textarea id="comment-text" placeholder="Add a comment..." required></textarea>
                    <button type="submit" class="btn">Post Comment</button>
                </form>
                
                <div id="comments-list" class="comments-list">
                    <!-- Comments will be added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Page -->
    <div id="quiz-page" class="page">
        <div class="quiz-container">
            <header>
                <button id="back-to-lesson" class="btn back-btn">← Back to Lesson</button>
                <h1 id="quiz-title">Quiz</h1>
            </header>
            
            <div id="quiz-questions">
                <!-- Questions will be added here -->
            </div>
            
            <button id="submit-quiz" class="btn">Submit Quiz</button>
        </div>
    </div>

    <script>
        // Sample data for the application
const sampleData = {
    users: [
        { id: 1, username: "admin", password: "admin123", isAdmin: true },
        { id: 2, username: "student1", password: "student123", isAdmin: false, mathLevel: 1, programmingLevel: "junior", englishLevel: "beginner" },
        { id: 3, username: "student2", password: "student123", isAdmin: false, mathLevel: 3, programmingLevel: "middle", englishLevel: "advanced" }
    ],
    courses: [
        // Math courses
        { id: 1, subject: "math", level: "level_1", title: "Mathematics Grades 3-4", description: "Basic arithmetic and geometry for young students", thumbnail: "https://static.abt.uz/crop/600__5ec0896d014f5.jpg" },
        { id: 2, subject: "math", level: "level_2", title: "Mathematics Grades 5-6", description: "Introduction to fractions and decimals", thumbnail: "https://static.abt.uz/crop/600__5ec0896d014f5.jpg" },
        { id: 3, subject: "math", level: "level_3", title: "Mathematics Grades 7-8", description: "Algebra fundamentals and basic geometry", thumbnail: "https://static.abt.uz/crop/600__5ec0896d014f5.jpg" },
        { id: 4, subject: "math", level: "level_4", title: "Mathematics Grades 9-10", description: "Advanced algebra and trigonometry", thumbnail: "https://static.abt.uz/crop/600__5ec0896d014f5.jpg" },
        { id: 5, subject: "math", level: "level_5", title: "Mathematics Grade 11", description: "Pre-calculus and advanced topics", thumbnail: "https://static.abt.uz/crop/600__5ec0896d014f5.jpg" },
        
        // Programming courses
        { id: 6, subject: "programming", level: "junior", title: "HTML & CSS Basics", description: "Learn the fundamentals of web development", thumbnail: "https://www.uzedu.uz/uploads/2022/05/LV_Yv-OKZGBcnfL_RsxJYf34MfAWeLKI.jpg" },
        { id: 7, subject: "programming", level: "middle", title: "JavaScript & TypeScript", description: "Client-side scripting and programming", thumbnail: "https://www.uzedu.uz/uploads/2022/05/LV_Yv-OKZGBcnfL_RsxJYf34MfAWeLKI.jpg" },
        { id: 8, subject: "programming", level: "senior", title: "Advanced Web Development", description: "Django, React, PHP and Laravel", thumbnail: "https://www.uzedu.uz/uploads/2022/05/LV_Yv-OKZGBcnfL_RsxJYf34MfAWeLKI.jpg" },
        
        // English courses
        { id: 9, subject: "english", level: "beginner", title: "English Beginner", description: "Basic vocabulary and simple sentences", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdTQowLzdS44JKSNv4eXJSpnYMuPCDDB5WrA&s" },
        { id: 10, subject: "english", level: "elementary", title: "English Elementary", description: "Building basic communication skills", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdTQowLzdS44JKSNv4eXJSpnYMuPCDDB5WrA&s" },
        { id: 11, subject: "english", level: "intermediate", title: "English Intermediate", description: "Conversational English and grammar", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdTQowLzdS44JKSNv4eXJSpnYMuPCDDB5WrA&s" },
        { id: 12, subject: "english", level: "advanced", title: "English Advanced", description: "Complex grammar and vocabulary", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdTQowLzdS44JKSNv4eXJSpnYMuPCDDB5WrA&s" },
        { id: 13, subject: "english", level: "proficient", title: "English Proficient", description: "Fluency and academic English", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdTQowLzdS44JKSNv4eXJSpnYMuPCDDB5WrA&s" }
    ],
    lessons: [
        // Math lessons
        { id: 1, courseId: 1, title: "Basic Addition", videoUrl: "https://www.youtube.com/embed/NybHckSEQBI", description: "Learn how to add numbers up to 100" },
        { id: 2, courseId: 2, title: "Introduction to Fractions", videoUrl: "https://www.youtube.com/watch?v=kZzoVCmUyKg&pp=ygUZSW50cm9kdWN0aW9uIHRvIEZyYWN0aW9ucw%3D%3D", description: "Understanding parts of a whole" },
        { id: 3, courseId: 3, title: "Algebra Basics", videoUrl: "https://www.youtube.com/watch?v=mza6QYH3oEw", description: "Solving simple equations" },
        
        // Programming lessons
        { id: 4, courseId: 6, title: "HTML Structure", videoUrl: "https://www.youtube.com/watch?v=FQdaUv95mR8&t=75s", description: "Creating your first HTML page" },
        { id: 5, courseId: 7, title: "JavaScript Functions", videoUrl: "https://www.youtube.com/watch?v=FOD408a0EzU", description: "Writing reusable code with functions" },
        
        // English lessons
        { id: 6, courseId: 9, title: "Greetings", videoUrl: "https://www.youtube.com/embed/embed_code6", description: "Basic greetings and introductions" }
    ],
    quizzes: [
        {
            id: 1,
            lessonId: 1,
            title: "Basic Addition Quiz",
            questions: [
                {
                    id: 1,
                    text: "What is 5 + 7?",
                    answers: [
                        { id: 1, text: "12", isCorrect: true },
                        { id: 2, text: "13", isCorrect: false },
                        { id: 3, text: "11", isCorrect: false },
                        { id: 4, text: "10", isCorrect: false }
                    ]
                },
                {
                    id: 2,
                    text: "What is 20 + 15?",
                    answers: [
                        { id: 5, text: "30", isCorrect: false },
                        { id: 6, text: "35", isCorrect: true },
                        { id: 7, text: "25", isCorrect: false },
                        { id: 8, text: "40", isCorrect: false }
                    ]
                }
                // More questions would be added here
            ]
        }
        // More quizzes would be added here
    ],
    comments: [
        { id: 1, lessonId: 1, userId: 2, username: "student1", text: "This was really helpful!", createdAt: "2023-05-15T10:30:00Z" },
        { id: 2, lessonId: 1, userId: 3, username: "student2", text: "I have a question about problem 3", createdAt: "2023-05-15T11:45:00Z" }
    ]
};

// Application state
let currentUser = null;
let currentLesson = null;
let currentQuiz = null;

// DOM Elements
const pages = {
    login: document.getElementById('login-page'),
    assessment: document.getElementById('assessment-page'),
    adminDashboard: document.getElementById('admin-dashboard'),
    studentDashboard: document.getElementById('student-dashboard'),
    lesson: document.getElementById('lesson-page'),
    quiz: document.getElementById('quiz-page')
};

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
    // Check if user is already logged in (from localStorage)
    const savedUser = localStorage.getItem('peerlearn_user');
    if (savedUser) {
        currentUser = JSON.parse(savedUser);
        if (currentUser.isAdmin) {
            showAdminDashboard();
        } else {
            showStudentDashboard();
        }
    } else {
        showPage('login');
    }
    
    // Set up event listeners
    setupEventListeners();
});

function setupEventListeners() {
    // Login form
    document.getElementById('login-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleLogin();
    });
    
    // Assessment form
    document.getElementById('assessment-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleAssessment();
    });
    
    // Logout buttons
    document.getElementById('logout-btn').addEventListener('click', handleLogout);
    document.getElementById('student-logout-btn').addEventListener('click', handleLogout);
    
    // Back buttons
    document.getElementById('back-to-courses').addEventListener('click', function() {
        showStudentDashboard();
    });
    
    document.getElementById('back-to-lesson').addEventListener('click', function() {
        showLessonPage(currentLesson);
    });
    
    // Start quiz button
    document.getElementById('start-quiz-btn').addEventListener('click', function() {
        startQuiz();
    });
    
    // Submit quiz button
    document.getElementById('submit-quiz').addEventListener('click', function() {
        submitQuiz();
    });
    
    // Comment form
    document.getElementById('comment-form').addEventListener('submit', function(e) {
        e.preventDefault();
        postComment();
    });
}

function showPage(pageName) {
    // Hide all pages
    Object.values(pages).forEach(page => {
        page.classList.remove('active');
    });
    
    // Show the requested page
    pages[pageName].classList.add('active');
}

function handleLogin() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const isAdmin = document.querySelector('input[name="user-type"]:checked').value === 'admin';
    
    // Find user in sample data
    const user = sampleData.users.find(u => 
        u.username === username && 
        u.password === password && 
        u.isAdmin === isAdmin
    );
    
    if (user) {
        currentUser = user;
        localStorage.setItem('peerlearn_user', JSON.stringify(user));
        
        if (isAdmin) {
            showAdminDashboard();
        } else {
            // Check if student has completed assessment
            if (user.mathLevel && user.programmingLevel && user.englishLevel) {
                showStudentDashboard();
            } else {
                showPage('assessment');
            }
        }
    } else {
        alert('Invalid username or password');
    }
}

function handleAssessment() {
    const mathLevel = document.querySelector('input[name="math-level"]:checked').value;
    const programmingLevel = document.querySelector('input[name="programming-level"]:checked').value;
    const englishLevel = document.querySelector('input[name="english-level"]:checked').value;
    
    // Update current user
    currentUser.mathLevel = parseInt(mathLevel);
    currentUser.programmingLevel = programmingLevel;
    currentUser.englishLevel = englishLevel;
    
    // Update in "database"
    const userIndex = sampleData.users.findIndex(u => u.id === currentUser.id);
    if (userIndex !== -1) {
        sampleData.users[userIndex] = currentUser;
    }
    
    localStorage.setItem('peerlearn_user', JSON.stringify(currentUser));
    showStudentDashboard();
}

function handleLogout() {
    currentUser = null;
    localStorage.removeItem('peerlearn_user');
    showPage('login');
}

function showAdminDashboard() {
    showPage('adminDashboard');
    
    // Update stats
    document.getElementById('total-users').textContent = sampleData.users.filter(u => !u.isAdmin).length;
    document.getElementById('active-today').textContent = sampleData.users.filter(u => !u.isAdmin).length; // Simplified
    document.getElementById('total-courses').textContent = sampleData.courses.length;
    
    // Update user progress table
    const tableBody = document.getElementById('user-progress-table');
    tableBody.innerHTML = '';
    
    sampleData.users.filter(u => !u.isAdmin).forEach(user => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${user.username}</td>
            <td>${user.mathLevel || 'Not set'}</td>
            <td>${user.programmingLevel || 'Not set'}</td>
            <td>${user.englishLevel || 'Not set'}</td>
            <td>Today</td>
        `;
        tableBody.appendChild(row);
    });
    
    // Update courses list
    const coursesContainer = document.getElementById('courses-container');
    coursesContainer.innerHTML = '';
    
    sampleData.courses.forEach(course => {
        const courseCard = document.createElement('div');
        courseCard.className = 'course-card';
        courseCard.innerHTML = `
            <img src="${course.thumbnail}" alt="${course.title}">
            <div class="course-info">
                <h3>${course.title}</h3>
                <p>${course.description}</p>
            </div>
        `;
        coursesContainer.appendChild(courseCard);
    });
}

function showStudentDashboard() {
    showPage('studentDashboard');
    
    // Update student info
    document.getElementById('student-name').textContent = currentUser.username;
    document.getElementById('math-level-display').textContent = currentUser.mathLevel;
    document.getElementById('programming-level-display').textContent = currentUser.programmingLevel;
    document.getElementById('english-level-display').textContent = currentUser.englishLevel;
    
    // Show recommended courses for each subject
    showRecommendedCourses('math', currentUser.mathLevel, 'math-courses');
    showRecommendedCourses('programming', currentUser.programmingLevel, 'programming-courses');
    showRecommendedCourses('english', currentUser.englishLevel, 'english-courses');
}

function showRecommendedCourses(subject, level, containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    
    let filteredCourses = [];
    
    if (subject === 'math') {
        filteredCourses = sampleData.courses.filter(c => 
            c.subject === subject && c.level === `level_${level}`
        );
    } else {
        filteredCourses = sampleData.courses.filter(c => 
            c.subject === subject && c.level === level.toLowerCase()
        );
    }
    
    if (filteredCourses.length === 0) {
        container.innerHTML = '<p>No courses available for your current level.</p>';
        return;
    }
    
    filteredCourses.forEach(course => {
        const courseCard = document.createElement('div');
        courseCard.className = 'course-card';
        courseCard.innerHTML = `
            <img src="${course.thumbnail}" alt="${course.title}">
            <div class="course-info">
                <h3>${course.title}</h3>
                <p>${course.description}</p>
                <button class="btn view-course-btn" data-course-id="${course.id}">View Course</button>
            </div>
        `;
        container.appendChild(courseCard);
    });
    
    // Add event listeners to view course buttons
    document.querySelectorAll('.view-course-btn').forEach(button => {
        button.addEventListener('click', function() {
            const courseId = parseInt(this.getAttribute('data-course-id'));
            const course = sampleData.courses.find(c => c.id === courseId);
            if (course) {
                // For simplicity, we'll show the first lesson of the course
                const lesson = sampleData.lessons.find(l => l.courseId === courseId);
                if (lesson) {
                    showLessonPage(lesson);
                } else {
                    alert('No lessons available for this course yet.');
                }
            }
        });
    });
}

function showLessonPage(lesson) {
    showPage('lesson');
    currentLesson = lesson;
    
    // Update lesson info
    document.getElementById('lesson-title').textContent = lesson.title;
    document.getElementById('lesson-video').src = lesson.videoUrl;
    document.getElementById('lesson-description-text').textContent = lesson.description;
    
    // Load comments
    loadComments(lesson.id);
    
    // Check if there's a quiz for this lesson
    const quiz = sampleData.quizzes.find(q => q.lessonId === lesson.id);
    if (quiz) {
        document.getElementById('start-quiz-btn').style.display = 'inline-block';
    } else {
        document.getElementById('start-quiz-btn').style.display = 'none';
    }
}

function loadComments(lessonId) {
    const commentsList = document.getElementById('comments-list');
    commentsList.innerHTML = '';
    
    const lessonComments = sampleData.comments.filter(c => c.lessonId === lessonId);
    
    if (lessonComments.length === 0) {
        commentsList.innerHTML = '<p>No comments yet. Be the first to comment!</p>';
        return;
    }
    
    lessonComments.forEach(comment => {
        const commentElement = document.createElement('div');
        commentElement.className = 'comment';
        commentElement.innerHTML = `
            <div class="comment-header">
                <div class="comment-avatar">${comment.username.charAt(0).toUpperCase()}</div>
                <span class="comment-author">${comment.username}</span>
                <span class="comment-date">${new Date(comment.createdAt).toLocaleString()}</span>
            </div>
            <div class="comment-body">
                <p>${comment.text}</p>
            </div>
        `;
        commentsList.appendChild(commentElement);
    });
}

function postComment() {
    const commentText = document.getElementById('comment-text').value.trim();
    
    if (commentText && currentUser && currentLesson) {
        const newComment = {
            id: sampleData.comments.length + 1,
            lessonId: currentLesson.id,
            userId: currentUser.id,
            username: currentUser.username,
            text: commentText,
            createdAt: new Date().toISOString()
        };
        
        sampleData.comments.push(newComment);
        document.getElementById('comment-text').value = '';
        loadComments(currentLesson.id);
    }
}

function startQuiz() {
    if (!currentLesson) return;
    
    const quiz = sampleData.quizzes.find(q => q.lessonId === currentLesson.id);
    if (!quiz) return;
    
    currentQuiz = quiz;
    showPage('quiz');
    
    // Update quiz title
    document.getElementById('quiz-title').textContent = quiz.title;
    
    // Display questions
    const quizQuestions = document.getElementById('quiz-questions');
    quizQuestions.innerHTML = '';
    
    quiz.questions.forEach((question, index) => {
        const questionElement = document.createElement('div');
        questionElement.className = 'quiz-question';
        questionElement.innerHTML = `
            <h3>Question ${index + 1}: ${question.text}</h3>
        `;
        
        question.answers.forEach(answer => {
            const answerElement = document.createElement('label');
            answerElement.className = 'quiz-option';
            answerElement.innerHTML = `
                <input type="radio" name="question_${question.id}" value="${answer.id}">
                ${answer.text}
            `;
            questionElement.appendChild(answerElement);
        });
        
        quizQuestions.appendChild(questionElement);
    });
}

function submitQuiz() {
    if (!currentQuiz) return;
    
    let score = 0;
    const totalQuestions = currentQuiz.questions.length;
    
    currentQuiz.questions.forEach(question => {
        const selectedAnswer = document.querySelector(`input[name="question_${question.id}"]:checked`);
        if (selectedAnswer) {
            const answerId = parseInt(selectedAnswer.value);
            const answer = question.answers.find(a => a.id === answerId);
            if (answer && answer.isCorrect) {
                score++;
            }
        }
    });
    
    // Calculate percentage
    const percentage = (score / totalQuestions) * 100;
    
    // Show result
    if (percentage >= 80) {
        alert(`Congratulations! You scored ${score}/${totalQuestions}. You've passed the quiz!`);
        
        // In a real app, we would update the user's level here
        // For now, we'll just show a message
        const course = sampleData.courses.find(c => c.id === currentLesson.courseId);
        if (course) {
            alert(`You've advanced to the next level in ${course.subject}!`);
        }
    } else {
        alert(`You scored ${score}/${totalQuestions}. You need at least 80% to pass. Please review the lesson and try again.`);
    }
    
    // Return to lesson page
    showLessonPage(currentLesson);
}

    </script>
</body>
</html>
